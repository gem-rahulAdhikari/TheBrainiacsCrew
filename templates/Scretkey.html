<!DOCTYPE html>
<html>
<head>
    <title>ScretKe page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='Scretkey.css') }}">
</head>
<body>
    

    <div id="secretKeyModal" class="modal">
        <div class="modal-content">
          <span class="close">&times;</span>
          <p>Enter secret key:</p>
          <input type="password" id="secretKeyInput">
          <button id="submitSecretKey">Submit</button>
        </div>
      </div>
     
    
</body>
<script>
const secretKeyModal = document.getElementById("secretKeyModal");
const secretKeyInput = document.getElementById("secretKeyInput");
const submitSecretKeyButton = document.getElementById("submitSecretKey");
const closeButton = document.querySelector(".close");

// This eventlistener will trigger when we click on submit button after entering the key.
submitSecretKeyButton.addEventListener("click", () => {
  console.log("hello");
  const validation = secretKeyInput.value.trim();
  if (validation === UserKey ) {
    document.getElementById("content").style.display = "block";
    secretKeyModal.style.display = "none";
  } else {
    alert("Invalid secret key, please try again!");
  }
});

//close the popup
closeButton.addEventListener("click", () => {
  secretKeyModal.style.display = "none";
});

// Add event listener to the window's load event
window.addEventListener('load', () => {
     fetch('https://us-east-1.aws.data.mongodb-api.com/app/application-0-awqqz/endpoint/getAdminTableData')
    .then(response => response.json())
    .then(data => {
      for (let i = 0; i < data.length; i++) {
       
        const item = data[i];
        if (currentUrl === item.url) {
          UserKey = item.SecretKey;
          break;
        }
      }
      
      secretKeyModal.style.display = "block";
      secretKeyInput.focus();
    })
    .catch(error => console.error(error));
});

</script>
</html>
